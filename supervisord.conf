[supervisord]
nodaemon=true

[program:jupyterlab]
; Jupyter defaults to loopback for safety. Override via env if you explicitly publish it.
; Run as the non-root user to avoid --allow-root.
command=/bin/bash -lc "su - ${USER:-aXonian} -c 'jupyter lab --ip=${JUPYTER_BIND:-127.0.0.1} --port=${JUPYTER_PORT:-8888} --no-browser'"

[program:vncserver]
command=/bin/bash -c "sleep 2 && su - aXonian -c 'mkdir -p ~/.vnc && vncserver :1 -geometry 1920x1080 && tail -F ~/.vnc/*.log'"
environment=HOME="/home/aXonian",USER="aXonian",DISPLAY=":1",XAUTHORITY="/home/aXonian/.Xauthority"
directory=/home/aXonian

[program:novnc]
command=/bin/bash -c "sleep 3 && python3 /axonos_gate/websockify_gate.py"
; Configuration is provided via container environment variables.

[program:axgt-api]
command=/bin/bash -c "sleep 4 && python3 /axonos_gate/gate_server.py"
; Bind the separate AXGT API to localhost by default to reduce external surface.
; The primary verify endpoint is served on the same origin via websockify_gate.py.
; Configuration is provided via container environment variables (gate defaults are localhost:8889).

[program:ollama]
command=ollama serve
autorestart=true

[program:ipfs]
command=/bin/bash -c "sleep 5 && su - aXonian -c 'ipfs daemon --enable-gc --routing=dht'"
user=aXonian
environment=HOME="/home/aXonian",USER="aXonian"
directory=/home/aXonian
autorestart=true
autostart=true
